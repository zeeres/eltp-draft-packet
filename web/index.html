<!DOCTYPE html>
<html ng-app="draftPacketApp">
    <head>
        <title>ELTP Draft Packet</title>

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="stylesheet" type="text/css" href="bower_components/bootstrap/dist/css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="bower_components/flag-icon-css/css/flag-icon.min.css">
        <link rel="stylesheet" type="text/css" href="style.css">

        <script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>

        <script src="bower_components/jquery/dist/jquery.min.js"></script>
        <script src="bower_components/popper.js/dist/popper.min.js"></script>
        <script src="bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script>

        <script src="bower_components/angular/angular.min.js"></script>
        <script src="app.js"></script>
    </head>
    <body ng-controller="draftPacketController">
        <div ng-if="loading" id="loading-overlay"></div>
        <div id="tools">
            <a href="#" title="Filter" data-toggle="tooltip" data-placement="right">
                <i class="fas fa-filter"></i>
            </a>
            <a href="#" title="Mark" data-toggle="tooltip" data-placement="right">
                <i class="fas fa-thumbtack"></i>
            </a>
            <a href="#" title="Export" data-toggle="tooltip" data-placement="right">
                <i class="fas fa-share-square"></i>
            </a>
            <div class="flex-filler"></div>
            <a href="https://github.com/arfie/eltp-draft-packet" title="Source" data-toggle="tooltip" data-placement="right">
                <i class="fab fa-github"></i>
            </a>
        </div>
        <div class="container">
            <div class="row">
                <div class="col-md-6" id="packet-container">
                    <table class="table table-sm table-striped table-hover" id="packet">
                        <thead>
                            <tr>
                                <th class="td-narrow"></th>
                                <th class="td-narrow"></th>
                                <th>Player</th>
                                <th>Rating</th>
                                <th class="hidden-xs">Position</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="row in dummy_rows" ng-if="loading" class="loading-tr">
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td class="hidden-xs"></td>
                            </tr>
                            <tr ng-repeat="row in packet" ng-class="{'table-active': selection == $index}" ng-click="select($index)">
                                <td class="td-narrow">
                                    <span ng-class="['flag-icon', 'flag-icon-' + row.country.code]"></span>
                                </td>
                                <td class="td-narrow">
                                    <span ng-class="['flair', row.flair]"></span>
                                </td>
                                <td>
                                    {{ row.name }}
                                </td>
                                <td>
                                    <stars rating="row.rating"></stars>
                                </td>
                                <td class="hidden-xs">
                                    {{ format_position(row.position) }}
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="col-md-6" id="right-panel">
                    <div id="selected-player-overview" ng-show="selection >= 0">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title">
                                    <span ng-class="['flair', player.flair]"></span>
                                    {{ player.name }}
                                    <a ng-click="select(-1)" class="btn close pull-right"><span>&times;</span></a>
                                    <small ng-if="player.old_name !== ''" class="text-muted">
                                        (formerly {{ player.old_name }})
                                    </small>
                                </h4>
                                <ul class="nav nav-tabs card-header-tabs" role="tablist">
                                    <li class="nav-item">
                                        <a id="nav-tab-information" class="nav-link active" data-toggle="tab" role="tab" href="#tab-information" aria-controls="tab-information" aria-selected="true">Information</a>
                                    </li>
                                    <li class="nav-item">
                                        <a id="nav-tab-availability-weekly" class="nav-link" data-toggle="tab" role="tab" href="#tab-availability-weekly" aria-controls="tab-availability-weekly" aria-selected="false">Weekly availability</a>
                                    </li>
                                    <li class="nav-item">
                                        <a id="nav-tab-availability-daily" class="nav-link" data-toggle="tab" role="tab" href="#tab-availability-daily" aria-controls="tab-availability-daily" aria-selected="false">Daily availability</a>
                                    </li>
                                    <li class="nav-item">
                                        <a id="nav-tab-stats" class="nav-link" data-toggle="tab" role="tab" href="#tab-stats" aria-controls="tab-stats" aria-selected="false">Stats</a>
                                    </li>
                                </ul>
                            </div>
                            <div class="tab-content">
                                <div id="tab-information" class="player-info tab-pane show active" role="tabpanel" aria-labelledby="nav-tab-information">
                                    <div class="w50">
                                        <a ng-href="http://tagpro-chord.koalabeast.com/profile/{{ player.profile }}">TagPro Profile</a>
                                    </div>
                                    <div class="w50">
                                        <span class="fab fa-reddit-alien"></span>&nbsp;<a ng-href="https://reddit.com/user/{{ player.reddit }}">u/{{ player.reddit }}</a>
                                    </div>
                                    <div class="w50">
                                        {{ format_position(player.position) }}
                                    </div>
                                    <div ng-if="player.microphone" class="w50">
                                        Has a microphone
                                    </div>
                                    <div ng-if="!player.microphone" class="text-danger w50">
                                        No microphone
                                    </div>
                                    <div class="w50">
                                        <span ng-class="['flag-icon', 'flag-icon-' + player.country.code]"></span>
                                        {{ player.country.name }}
                                    </div>
                                    <div class="w25">
                                        Chord: {{ player.ping.chord }}
                                    </div>
                                    <div class="w25">
                                        Orbit: {{ player.ping.orbit }}
                                    </div>
                                    <div ng-if="player.comment !== ''" class="w100">
                                        {{ player.comment }}
                                    </div>
                                </div>
                                <div id="tab-availability-weekly" class="card-block tab-pane" role="tabpanel" aria-labelledby="nav-tab-availability-weekly">
                                    <div class="card-body">
                                        {{ player.availability.comment }}
                                    </div>
                                    <table class="table table-sm">
                                        <thead>
                                            <tr>
                                                <th class="align-right">Week</th>
                                                <th>S</th>
                                                <th>M</th>
                                                <th>T</th>
                                                <th class="align-right">Week</th>
                                                <th>S</th>
                                                <th>M</th>
                                                <th>T</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="week in weekly_availability">
                                                <td class="align-right">{{ weeknames[$index].first }}</td>
                                                <td><availability available="week.first[0]"></availability></td>
                                                <td><availability available="week.first[1]"></availability></td>
                                                <td><availability available="week.first[2]"></availability></td>
                                                <td class="align-right">{{ weeknames[$index].second }}</td>
                                                <td><availability available="week.second[0]"></availability></td>
                                                <td><availability available="week.second[1]"></availability></td>
                                                <td><availability available="week.second[2]"></availability></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div id="tab-availability-daily" class="card-block tab-pane" role="tabpanel" aria-labelledby="nav-tab-availability-daily">
                                    <div class="card-body">
                                        {{ player.availability.comment }}
                                    </div>
                                    <table class="table table-sm">
                                        <thead>
                                            <tr>
                                                <th>Day</th>
                                                <th>Availability</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="day in weekdays">
                                                <td>{{ day }}</td>
                                                <td>
                                                    <dailyavailability available="player.availability.daily[$index]"></dailyavailability>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div id="tab-stats" class="card-block tab-pane" role="tabpanel" aria-labelledby="nav-tab-stats">
                                    <div class="player-info">
                                        <div class="w50">
                                            <strong>Current win rate:</strong>
                                            {{ player.stats.rolling.current | percentage : 2 }}
                                        </div>
                                        <div class="w50">
                                            <strong>Best win rate:</strong>
                                            {{ player.stats.rolling.best | percentage : 2 }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>
